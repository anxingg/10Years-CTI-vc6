// ListBoxExBuddy.h: interface for the CListBoxExBuddy class.
//
//////////////////////////////////////////////////////////////////////

#if !defined(AFX_LISTBOXEXBUDDY_H__584199CB_D748_4CAA_983E_73D35336EA13__INCLUDED_)
#define AFX_LISTBOXEXBUDDY_H__584199CB_D748_4CAA_983E_73D35336EA13__INCLUDED_

#if _MSC_VER > 1000
#pragma once
#endif // _MSC_VER > 1000

#define WM_LISTBOXEXBUDDY_NEW	WM_USER + 100
#define WM_LISTBOXEXBUDDY_EDIT	WM_USER + 101
#define WM_LISTBOXEXBUDDY_DEL	WM_USER + 102
#define WM_LISTBOXEXBUDDY_UP	WM_USER + 103
#define WM_LISTBOXEXBUDDY_DOWN  WM_USER + 104

static const unsigned char lbbuddy_data[] = {
  0x42, 0x4d, 0xe6, 0x03, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x76, 0x00, 0x00, 0x00, 0x28, 0x00,
  0x00, 0x00, 0x58, 0x00, 0x00, 0x00, 0x14, 0x00,
  0x00, 0x00, 0x01, 0x00, 0x04, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x70, 0x03, 0x00, 0x00, 0xc4, 0x0e,
  0x00, 0x00, 0xc4, 0x0e, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x80, 0x00, 0x00, 0x80,
  0x00, 0x00, 0x00, 0x80, 0x80, 0x00, 0x80, 0x00,
  0x00, 0x00, 0x80, 0x00, 0x80, 0x00, 0x80, 0x80,
  0x00, 0x00, 0x80, 0x80, 0x80, 0x00, 0xc0, 0xc0,
  0xc0, 0x00, 0x00, 0x00, 0xff, 0x00, 0x00, 0xff,
  0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0xff, 0x00,
  0x00, 0x00, 0xff, 0x00, 0xff, 0x00, 0xff, 0xff,
  0x00, 0x00, 0xff, 0xff, 0xff, 0x00, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x81, 0xf8, 0x88, 0x88, 0x88,
  0x81, 0xf8, 0x88, 0x88, 0x88, 0x88, 0x88, 0x80,
  0x00, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x08, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x80, 0x88, 0x88, 0x88, 0x88, 0x88, 0x11,
  0x1f, 0x88, 0x88, 0x88, 0x1f, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x00, 0x08, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x80,
  0x00, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x08, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x11, 0x1f, 0x88, 0x88, 0x81,
  0xf8, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x80, 0x00, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x00, 0x00, 0x08, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x80, 0x88, 0x88, 0x88, 0x88, 0x88, 0x81,
  0x11, 0xf8, 0x88, 0x11, 0xf8, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x80, 0x00, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x80, 0x00,
  0x00, 0x00, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x08, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x11, 0x1f, 0x81, 0x1f,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x80, 0x00, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x00, 0x00, 0x00, 0x00, 0x08, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x78, 0x88, 0x88,
  0x88, 0x80, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x81, 0x11, 0x11, 0xf8, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x80, 0x00, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x80, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x88, 0x88, 0x88, 0x88, 0x87,
  0x08, 0x7b, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x11, 0x1f, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x80, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x80, 0x00, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0xb8, 0x78, 0xb7, 0x88,
  0x88, 0x80, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x81, 0x11, 0x11, 0xf8, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x00, 0x00, 0x00, 0x00, 0x08,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x80,
  0x00, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x87,
  0x77, 0x8b, 0xb8, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x11, 0x1f, 0x81, 0xf8,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x80,
  0x00, 0x00, 0x00, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x80, 0x00, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0xb7, 0xbf, 0x77, 0x77,
  0x88, 0x80, 0x88, 0x88, 0x88, 0x88, 0x88, 0x11,
  0x11, 0xf8, 0x88, 0x11, 0xf8, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x00, 0x00, 0x08, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x80,
  0x00, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x78, 0x7b, 0x7b, 0x08, 0x08, 0x08, 0x88, 0x88,
  0x88, 0x88, 0x81, 0x11, 0x1f, 0x88, 0x88, 0x81,
  0x1f, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x80, 0x00, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x00, 0x08, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x87, 0x88, 0x7f, 0x87, 0xb8,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x81, 0x1f,
  0x88, 0x88, 0x88, 0x88, 0x11, 0xf8, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x08, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x80, 0x00, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88, 0x88,
  0x88, 0x88, 0x88, 0x88, 0x88, 0x88
 
};

#define __bmp_size   sizeof( lbbuddy_data )

#define __BMP_WIDTH  110
#define __BMP_HEIGHT 20
#define __BMP_BTNWID 22

#define __BTN_NEW     0
#define __BTN_EDIT    1
#define __BTN_DEL     2
#define __BTN_UP      3
#define __BTN_DOWN    4
#define __BMP_NUMBTN  5

class CListBoxExBuddy: public CWnd
{
public:

   CListBoxExBuddy();
   virtual ~CListBoxExBuddy();
   
public:
	virtual BOOL MySubclassDlgItem(UINT nID, CWnd* pParent);
   
   void SetListbox( HWND hWnd ) 
   { 
	  m_hWnd = hWnd;
   };

   // Overrides
   // ClassWizard generated virtual function overrides
   //{{AFX_VIRTUAL(CListBoxExBuddy)
protected:
   virtual void PreSubclassWindow();
   virtual BOOL OnNotify(WPARAM wParam, LPARAM lParam, LRESULT* pResult);
   //}}AFX_VIRTUAL
   
   // Generated message map functions
protected:
   //{{AFX_MSG(CListBoxExBuddy)
   afx_msg void OnPaint();
   afx_msg void OnMouseMove(UINT nFlags, CPoint point);
   afx_msg void OnLButtonDown(UINT nFlags, CPoint point);
   afx_msg void OnLButtonUp(UINT nFlags, CPoint point);
   afx_msg void OnSize(UINT nType, int cx, int cy);
   afx_msg void OnNcMouseMove(UINT nHitTest, CPoint point);
	afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct);
	//}}AFX_MSG
   DECLARE_MESSAGE_MAP()

private:

   void CreateTooltips();
   void SetTipText( UINT nID, LPTSTR szTipText );

   int FindButton( const CPoint & point );
   void InvalidateButton( int iIndex, BOOL bUpdateWindow = TRUE );
   void DoClick( int iIndex );

private:
   HWND m_hWnd;
   CBitmap       m_ButtonBitmap;
   UINT          m_iButton;
   BOOL          m_bButtonPressed;
   CRect        *m_arcButtons;

   CToolTipCtrl  m_ToolTip;
	UINT m_nID;
}; // class CListBoxExBuddy


#endif // !defined(AFX_LISTBOXEXBUDDY_H__584199CB_D748_4CAA_983E_73D35336EA13__INCLUDED_)
